<!DOCTYPE html>
<html lang="fr">
<head>
    <!-- VERSION AVEC L'ANALYSE DU GRAPHIQUE √âNERG√âTIQUE -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Num√©rologie Strat√©gique Expert</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,600;1,400&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

    <!-- === SECTION CSS (AVEC AJOUTS POUR L'ANALYSE) === -->
    <style>
        :root {
            --primary-color: #3a0ca3; --secondary-color: #7209b7; --background-color: #f5f3f4;
            --text-color: #212529; --card-bg: #ffffff; --border-radius: 12px;
            --box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08); --summary-border: #4361ee;
            --ai-btn-bg: #0077b6; --ai-btn-hover: #023e8a; --karmic-bg: #fffbe6; --karmic-border: #ffc107;
        }
        body.dark-mode {
            --primary-color: #9d4edd; --secondary-color: #c77dff; --background-color: #121212;
            --text-color: #e0e0e0; --card-bg: #1e1e1e;
            --box-shadow: 0 6px 20px rgba(255, 255, 255, 0.05); --summary-border: #80ffdb;
            --ai-btn-bg: #48cae4; --ai-btn-hover: #00b4d8; --karmic-bg: #332b00; --karmic-border: #ffc107;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        html { scroll-behavior: smooth; }
        body { font-family: 'Poppins', sans-serif; background-color: var(--background-color); color: var(--text-color); margin: 0; padding: 20px; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; transition: background-color 0.3s, color 0.3s; }
        .container { max-width: 800px; width: 100%; }
        header { text-align: center; margin-bottom: 20px; color: var(--primary-color); position: relative; }
        header h1 { font-family: 'Lora', serif; font-size: 2.8em; font-weight: 600; }
        .theme-switch-wrapper { display: flex; align-items: center; justify-content: center; gap: 10px; margin-top: 15px; }
        .theme-switch { display: inline-block; height: 24px; position: relative; width: 50px; }
        .theme-switch input { display: none; }
        .slider { background-color: #ccc; bottom: 0; left: 0; right: 0; top: 0; position: absolute; cursor: pointer; transition: .4s; border-radius: 24px; }
        .slider:before { background-color: white; bottom: 4px; left: 4px; content: ""; height: 16px; width: 16px; position: absolute; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--secondary-color); }
        input:checked + .slider:before { transform: translateX(26px); }
        main { background: var(--card-bg); padding: 30px 40px; border-radius: var(--border-radius); box-shadow: var(--box-shadow); transition: background-color 0.3s; }
        #welcome-back { padding: 15px; background-color: color-mix(in srgb, var(--summary-border) 80%, #000 20%); color: white; border-radius: var(--border-radius); margin-bottom: 20px; text-align: center; font-weight: 600; }
        .input-group { margin-bottom: 20px; }
        .input-group label { display: block; margin-bottom: 8px; font-weight: 600; color: var(--primary-color); }
        .input-group input { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: var(--border-radius); font-size: 1em; font-family: 'Poppins', sans-serif; box-sizing: border-box; background-color: var(--card-bg); color: var(--text-color); transition: border-color 0.3s, box-shadow 0.3s; }
        button { width: 100%; padding: 15px; background: linear-gradient(45deg, var(--secondary-color), var(--primary-color)); color: white; border: none; border-radius: var(--border-radius); font-size: 1.2em; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        button:hover:not(:disabled) { transform: translateY(-3px); box-shadow: 0 8px 25px rgba(58, 12, 163, 0.4); }
        button:disabled { background: #999; cursor: not-allowed; transform: translateY(0); box-shadow: none; }
        #results-wrapper { margin-top: 40px; }
        .card { opacity: 0; background-color: var(--card-bg); padding: 25px; margin-bottom: 25px; border-radius: var(--border-radius); border-left: 6px solid var(--secondary-color); box-shadow: 0 4px 10px rgba(0,0,0,0.05); transition: background-color 0.3s, border-color 0.3s; }
        .card.fade-in { animation: fadeIn 0.5s ease-out forwards; }
        .summary-card { border-left-color: var(--summary-border); background-color: color-mix(in srgb, var(--card-bg) 95%, var(--summary-border) 5%); }
        h2 { margin-top: 0; margin-bottom: 15px; color: var(--primary-color); display: flex; align-items: center; font-family: 'Lora', serif; font-size: 1.8em; }
        .number-circle { flex-shrink: 0; display: inline-flex; justify-content: center; align-items: center; width: 50px; height: 50px; background-color: var(--secondary-color); color: white; border-radius: 50%; font-size: 1.6em; font-weight: 600; margin-right: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        p { line-height: 1.7; }
        .description { font-style: italic; color: #555; margin-bottom: 15px; font-family: 'Lora', serif; }
        body.dark-mode .description { color: #aaa; }
        .karmic-warning { background-color: var(--karmic-bg); border: 1px solid var(--karmic-border); border-radius: var(--border-radius); padding: 15px; margin-top: 20px; color: color-mix(in srgb, var(--karmic-border) 80%, #000 20%);}
        body.dark-mode .karmic-warning { color: var(--karmic-border); }
        details { margin-top: 20px; }
        summary { cursor: pointer; font-weight: 600; color: var(--primary-color); }
        .calculation-details { font-size: 0.9em; color: #444; background: color-mix(in srgb, var(--background-color) 80%, #000 20%); padding: 10px 15px; border-radius: var(--border-radius); margin-top: 8px; }
        body.dark-mode .calculation-details { color: #ddd; background: #2c2c2c; }
        .energy-chart-container { display: flex; justify-content: space-around; align-items: flex-end; height: 150px; padding: 10px; margin-top: 15px; }
        .bar-wrapper { display: flex; flex-direction: column; align-items: center; height: 100%; justify-content: flex-end; flex: 1; }
        .bar { width: 70%; background-color: var(--secondary-color); border-radius: 5px 5px 0 0; transition: height 0.5s ease-out; position: relative; }
        .bar .tooltip { visibility: hidden; width: 120px; background-color: #333; color: #fff; text-align: center; border-radius: 6px; padding: 5px 0; position: absolute; z-index: 1; bottom: 105%; left: 50%; margin-left: -60px; opacity: 0; transition: opacity 0.3s; font-size: 0.9em; }
        .bar:hover .tooltip { visibility: visible; opacity: 1; }
        .bar-label { margin-top: 5px; font-weight: 600; }
        .energy-analysis { margin-top: 20px; padding-top: 20px; border-top: 1px solid color-mix(in srgb, var(--background-color) 50%, #000 50%); }
        .life-cycles-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .cycle-card { padding: 15px; border: 1px solid color-mix(in srgb, var(--background-color) 50%, #000 50%); border-radius: var(--border-radius); }
        .cycle-card h3 { margin-top: 0; color: var(--primary-color); }
        .action-buttons { display: flex; gap: 15px; margin-top: 20px; }
        #print-btn { background: #6c757d; }
        #ai-export-btn { background: var(--ai-btn-bg); }
        #ai-export-btn:hover:not(:disabled) { background: var(--ai-btn-hover); }
        .hidden { display: none; }
        footer { text-align: center; margin-top: 40px; font-size: 0.9em; color: #777; }
        @media print { body { padding: 0; margin: 20px; background-color: #fff; color: #000; } header, main > form, footer, .action-buttons, .theme-switch-wrapper, #welcome-back { display: none; } main, .container { box-shadow: none; padding: 0; } .card { page-break-inside: avoid; box-shadow: none; border: 1px solid #ddd; background-color: #fff !important; opacity: 1 !important; animation: none !important; } details { display: none; } }
    </style>
</head>
<body>
    <div class="container">
        <header><h1>üîÆ Num√©rologie Strat√©gique Expert</h1><p>D√©couvrez les √©nergies qui fa√ßonnent votre vie.</p><div class="theme-switch-wrapper"><span>‚òÄÔ∏è</span><label class="theme-switch"><input type="checkbox" id="theme-toggle"><span class="slider"></span></label><span>üåô</span></div></header>
        <main>
            <div id="welcome-back" class="hidden"></div>
            <form id="numerology-form"><div class="input-group"><label for="full-name">Noms et Pr√©noms complets (de naissance)</label><input type="text" id="full-name" placeholder="Ex: Marie Anne Claire Dubois" required></div><div class="input-group"><label for="birth-date">Date de naissance</label><input type="date" id="birth-date" required></div><button type="submit">Calculer mon Th√®me Complet</button></form>
            <div id="results-wrapper" class="hidden"><div id="summary-container"></div><div id="energy-presence-container"></div><div id="life-cycles-container"></div><div id="results-container"></div><div class="action-buttons"><button id="ai-export-btn">‚ú® Analyser avec une IA</button><button id="print-btn">üñ®Ô∏è Imprimer / PDF</button></div></div>
        </main>
        <footer><p>Application cr√©√©e pour la d√©couverte de soi. Ne remplace pas un conseil professionnel.</p></footer>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const elements = { form: document.getElementById('numerology-form'), nameInput: document.getElementById('full-name'), dateInput: document.getElementById('birth-date'), resultsWrapper: document.getElementById('results-wrapper'), summaryContainer: document.getElementById('summary-container'), energyContainer: document.getElementById('energy-presence-container'), cyclesContainer: document.getElementById('life-cycles-container'), resultsContainer: document.getElementById('results-container'), printBtn: document.getElementById('print-btn'), aiExportBtn: document.getElementById('ai-export-btn'), themeToggle: document.getElementById('theme-toggle'), welcomeBack: document.getElementById('welcome-back') };
            const letterValues = { 'A':1,'J':1,'S':1, 'B':2,'K':2,'T':2, 'C':3,'L':3,'U':3, 'D':4,'M':4,'V':4, 'E':5,'N':5,'W':5, 'F':6,'O':6,'X':6, 'G':7,'P':7,'Y':7, 'H':8,'Q':8,'Z':8, 'I':9,'R':9 };
            const vowels = ['A', 'E', 'I', 'O', 'U', 'Y'];
            const karmicDebtsMap = { 13: "la paresse et le travail", 14: "les abus des sens et l'instabilit√©", 16: "l'orgueil et la destruction de l'ego", 19: "l'√©go√Øsme et l'abus de pouvoir" };
            const energyKeywords = { 1: "Leader", 2: "Diplomate", 3: "Cr√©atif", 4: "B√¢tisseur", 5: "Aventurier", 6: "Responsable", 7: "Sage", 8: "Puissant", 9: "Humaniste"};
            
            const interpretations = { /* INTERPR√âTATIONS COMPL√àTES ICI */
                cheminDeVie: { 1: "<strong>Le Leader :</strong> Votre mission est d'apprendre l'ind√©pendance, l'innovation et le leadership. Vous √™tes ici pour ouvrir des voies, diriger par l'exemple et d√©velopper votre confiance en vous. Votre plus grand d√©fi est de croire en vos propres id√©es sans d√©pendre de l'approbation des autres.", 2: "<strong>Le Diplomate :</strong> Votre chemin est celui de la coop√©ration, de la diplomatie et de l'harmonie. Vous √™tes ici pour apprendre √† travailler en √©quipe, √† √™tre sensible aux besoins des autres et √† cr√©er des liens. Le d√©fi est de trouver votre propre voix et de ne pas vous effacer au profit des autres.", 3: "<strong>Le Communicant :</strong> Vous √™tes sur un chemin de cr√©ativit√©, d'expression et de joie de vivre. Votre mission est de communiquer, d'inspirer et d'apporter de l'optimisme au monde. Le d√©fi est de ne pas disperser votre √©nergie et de rester concentr√© sur vos projets cr√©atifs jusqu'√† leur aboutissement.", 4: "<strong>Le B√¢tisseur :</strong> Votre mission est de construire, d'organiser et d'apporter de la stabilit√©. Vous √™tes ici pour cr√©er des fondations solides, que ce soit dans votre carri√®re, votre famille ou vos projets. Le d√©fi est d'accepter la flexibilit√© et de ne pas devenir trop rigide dans vos structures.", 5: "<strong>L'Aventurier :</strong> Votre chemin est celui du changement, de la libert√© et de l'aventure. Vous √™tes ici pour exp√©rimenter la vie sous toutes ses facettes et apprendre l'adaptabilit√©. Le d√©fi est de trouver un √©quilibre entre libert√© et discipline pour ne pas vous perdre dans une qu√™te de sensations sans fin.", 6: "<strong>Le Responsable :</strong> Votre mission est li√©e √† l'amour, la responsabilit√© et le service aux autres, en particulier la famille et la communaut√©. Vous √™tes ici pour apprendre √† prendre soin, √† harmoniser et √† conseiller. Le d√©fi est de ne pas tomber dans le sacrifice et de savoir prendre soin de vous-m√™me.", 7: "<strong>Le Sage :</strong> Votre chemin est une qu√™te de connaissance, de v√©rit√© et de spiritualit√©. Vous √™tes ici pour analyser, comprendre les myst√®res de la vie et partager votre sagesse. Le d√©fi est de ne pas vous isoler du monde et d'apprendre √† faire confiance √† votre intuition autant qu'√† votre intellect.", 8: "<strong>Le Puissant :</strong> Votre mission est d'apprendre la ma√Ætrise du monde mat√©riel, le pouvoir et l'abondance. Vous √™tes ici pour d√©velopper votre ambition, g√©rer des projets d'envergure et trouver un √©quilibre entre le mat√©riel et le spirituel. Le d√©fi est d'utiliser votre pouvoir de mani√®re juste et √©thique.", 9: "<strong>L'Humaniste :</strong> Votre chemin est celui de l'altruisme, de la compassion et de la vision universelle. Vous √™tes ici pour servir l'humanit√©, inspirer les autres par votre sagesse et apprendre le l√¢cher-prise. Le d√©fi est d'accepter les imperfections du monde et de vivre dans le pr√©sent.", 11: "<strong>L'Inspir√© (Ma√Ætre Nombre) :</strong> C'est le chemin du 2 √† une haute vibration. Votre mission est d'√™tre un canal d'inspiration et de r√©v√©lation pour les autres. Vous avez une intuition puissante et une vision id√©aliste. Le d√©fi est de g√©rer votre hypersensibilit√© et d'ancrer vos visions dans la r√©alit√© concr√®te.", 22: "<strong>Le Grand B√¢tisseur (Ma√Ætre Nombre) :</strong> C'est le chemin du 4 √† une tr√®s haute vibration. Votre mission est de transformer des r√™ves ambitieux en r√©alisations concr√®tes qui b√©n√©ficient √† un grand nombre. Vous √™tes un 'ma√Ætre constructeur'. Le d√©fi est de g√©rer l'√©norme pression et de ne pas douter de votre capacit√© √† r√©aliser l'impossible.", 33: "<strong>Le Guide Spirituel (Ma√Ætre Nombre) :</strong> Extr√™mement rare, c'est le chemin du 6 √† sa plus haute expression. Votre mission est le service d√©sint√©ress√© et la compassion universelle. Vous √™tes un ma√Ætre de la gu√©rison et de l'enseignement. Le d√©fi est de porter ce lourd fardeau d'amour inconditionnel sans vous √©puiser." },
                expression: { 1: "<strong>Le Pionnier :</strong> Vos talents naturels r√©sident dans votre capacit√© √† initier, diriger et √™tre original. Vous √™tes fait pour √™tre ind√©pendant et prendre des d√©cisions audacieuses. Votre potentiel s'exprime pleinement lorsque vous √™tes aux commandes.", 2: "<strong>Le Partenaire :</strong> Vous poss√©dez des dons pour la collaboration, la m√©diation et la cr√©ation d'harmonie. Vous savez instinctivement comment rassembler les gens. Votre potentiel s'√©panouit dans les associations et les r√¥les de soutien.", 3: "<strong>L'Artiste Cr√©atif :</strong> Votre potentiel s'exprime √† travers la communication, la cr√©ativit√© et l'interaction sociale. Vous avez un don pour les mots, l'art et la mise en sc√®ne. Vous √™tes n√© pour inspirer la joie.", 4: "<strong>L'Organisateur :</strong> Vous avez un talent inn√© pour l'organisation, la planification et le travail m√©ticuleux. Vous √™tes fiable, pragmatique et capable de construire des syst√®mes durables. Votre potentiel est dans la concr√©tisation.", 5: "<strong>Le Communicateur Charismatique :</strong> Vos talents sont la polyvalence, l'adaptabilit√© et la capacit√© √† communiquer avec aisance. Vous savez vendre des id√©es et vous adapter au changement. Votre potentiel est dans le mouvement et la vari√©t√©.", 6: "<strong>Le Conseiller Protecteur :</strong> Vous avez un don pour le conseil, l'enseignement et la prise en charge des autres. Vous cr√©ez l'harmonie et la beaut√© autour de vous. Votre potentiel est dans le service et la responsabilit√©.", 7: "<strong>Le Chercheur de V√©rit√© :</strong> Vos talents sont l'analyse, la recherche et l'intuition. Vous √™tes un sp√©cialiste qui aime aller au fond des choses. Votre potentiel s'exprime dans les domaines de la connaissance et de la spiritualit√©.", 8: "<strong>Le Manager Ambitieux :</strong> Vous poss√©dez un potentiel exceptionnel pour les affaires, la finance et le management. Vous avez une vision strat√©gique et une grande force de travail. Votre don est de manifester la r√©ussite mat√©rielle.", 9: "<strong>Le Grand Humaniste :</strong> Vos talents sont la compassion, la cr√©ativit√© et une vision large du monde. Vous √™tes capable d'inspirer des groupes entiers. Votre potentiel est dans les projets √† port√©e universelle et artistique.", 11: "<strong>Le Visionnaire Intuitif :</strong> Vous avez le potentiel d'un leader charismatique et inspirant. Vos id√©es sont avant-gardistes et votre intuition est votre meilleur guide. Vous √™tes destin√© √† √©clairer les autres.", 22: "<strong>Le Ma√Ætre B√¢tisseur :</strong> Vous avez le potentiel de r√©aliser des projets d'une envergure exceptionnelle. Vous alliez vision et pragmatisme pour cr√©er des ≈ìuvres durables et utiles √† la soci√©t√©. Votre potentiel est quasi illimit√©.", 33: "<strong>Le Ma√Ætre Enseignant :</strong> Votre potentiel est celui d'un guide spirituel et d'un gu√©risseur. Vous exprimez un amour et une compassion profonds qui inspirent et √©l√®vent les autres. Votre don est celui du sacrifice altruiste." },
                ame: { 1: "<strong>D√©sir d'Ind√©pendance :</strong> Au plus profond de vous, vous aspirez √† √™tre le num√©ro un, √† diriger votre propre vie et √† √™tre reconnu pour vos r√©ussites individuelles. Vous d√©testez recevoir des ordres et avez besoin d'autonomie.", 2: "<strong>D√©sir d'Harmonie :</strong> Votre √¢me recherche l'amour, la paix et l'union. Vous √™tes profond√©ment heureux lorsque vous √™tes en partenariat, que ce soit en amiti√©, en amour ou au travail. Le conflit vous est insupportable.", 3: "<strong>D√©sir d'Expression :</strong> Vous avez un besoin vital de cr√©er, de communiquer et d'exprimer votre joie de vivre. L'art, l'√©criture, la musique ou simplement le fait d'√™tre sociable sont essentiels √† votre bonheur.", 4: "<strong>D√©sir de Stabilit√© :</strong> Votre motivation la plus profonde est la qu√™te de s√©curit√© et de structure. Vous avez besoin d'un cadre, de r√®gles et d'un plan solide pour vous sentir en paix. Le d√©sordre et l'incertitude vous angoissent.", 5: "<strong>D√©sir de Libert√© :</strong> Votre √¢me a soif de changement, de voyage, d'aventure et de nouvelles exp√©riences. Vous avez besoin de vous sentir libre de toute contrainte et d'explorer le monde. La routine vous √©touffe.", 6: "<strong>D√©sir de Service :</strong> Vous √™tes anim√© par un profond besoin de prendre soin des autres, de cr√©er un foyer harmonieux et de vous sentir utile √† votre communaut√©. L'amour et la responsabilit√© sont vos moteurs.", 7: "<strong>D√©sir de Connaissance :</strong> Votre √¢me est celle d'un chercheur. Vous avez un besoin insatiable de comprendre, d'analyser et de percer les myst√®res de la vie. La solitude et la r√©flexion vous ressourcent.", 8: "<strong>D√©sir de Ma√Ætrise :</strong> Au fond de vous, vous aspirez au succ√®s, √† la reconnaissance et √† la ma√Ætrise du monde mat√©riel. Vous √™tes motiv√© par les d√©fis et le d√©sir d'atteindre des postes de pouvoir et d'influence.", 9: "<strong>D√©sir d'Universalit√© :</strong> Votre √¢me est tourn√©e vers l'humanit√©. Vous √™tes motiv√© par de grandes causes, le d√©sir d'aider les autres et de contribuer √† un monde meilleur. Vous avez une vision large et g√©n√©reuse.", 11: "<strong>D√©sir de R√©v√©lation :</strong> Votre √¢me aspire √† une connexion spirituelle intense et √† l'inspiration. Vous √™tes motiv√© par des id√©aux √©lev√©s et le d√©sir d'apporter une lumi√®re nouvelle au monde. Vous cherchez la v√©rit√© au-del√† des apparences.", 22: "<strong>D√©sir de B√¢tir pour l'Humanit√© :</strong> Votre √¢me a des ambitions grandioses. Vous ne d√©sirez pas seulement construire, mais construire quelque chose de monumental qui laissera une trace durable et servira le plus grand nombre.", 33: "<strong>D√©sir d'Amour Inconditionnel :</strong> Votre d√©sir le plus profond est de gu√©rir le monde par la compassion et le service total. Vous √™tes motiv√© par un amour universel qui transcende les liens personnels." },
                personnalite: { 1: "<strong>L'Image du Chef :</strong> Vous apparaissez aux autres comme une personne confiante, d√©termin√©e et ind√©pendante. On vous per√ßoit comme un leader naturel, parfois un peu autoritaire mais toujours pr√™t √† prendre les devants.", 2: "<strong>L'Image du Diplomate :</strong> Les autres vous voient comme quelqu'un de charmant, coop√©ratif et attentionn√©. Vous projetez une image de douceur et de tact, et l'on vient naturellement vous demander conseil ou m√©diation.", 3: "<strong>L'Image de l'Artiste Sociable :</strong> On vous per√ßoit comme quelqu'un de p√©tillant, d'optimiste et de tr√®s communicatif. Vous avez une aura de cr√©ativit√© et de joie de vivre qui attire les autres √† vous.", 4: "<strong>L'Image du Pilier Fiable :</strong> Vous projetez une image de s√©rieux, de stabilit√© et de fiabilit√©. Les autres vous voient comme quelqu'un de travailleur, d'organis√© et sur qui l'on peut toujours compter.", 5: "<strong>L'Image de l'Aventurier Charismatique :</strong> On vous per√ßoit comme une personne magn√©tique, adaptable et pleine d'entrain. Vous donnez l'impression de ne jamais avoir peur du changement et de toujours √™tre pr√™t pour une nouvelle aventure.", 6: "<strong>L'Image du Parent Universel :</strong> Les autres vous voient comme une personne chaleureuse, responsable et bienveillante. Vous projetez une aura de protection et de conseil, et l'on se sent en s√©curit√© √† vos c√¥t√©s.", 7: "<strong>L'Image du Sage Myst√©rieux :</strong> On vous per√ßoit comme quelqu'un d'intelligent, de r√©serv√© et d'un peu √©nigmatique. Vous donnez l'impression d'observer et d'analyser le monde avec une grande profondeur.", 8: "<strong>L'Image de la Puissance :</strong> Vous projetez une image de force, d'ambition et de contr√¥le. Les autres vous voient comme quelqu'un de comp√©tent, de puissant et destin√© au succ√®s mat√©riel.", 9: "<strong>L'Image de l'Humaniste Sage :</strong> On vous per√ßoit comme une personne tol√©rante, g√©n√©reuse et charismatique. Vous d√©gagez une sagesse et une ouverture d'esprit qui inspirent le respect et l'admiration.", 11: "<strong>L'Image de l'Intuitif Inspir√© :</strong> Les autres vous voient comme quelqu'un d'√©lectrique, d'intuitif et de visionnaire. Vous pouvez sembler un peu nerveux ou intense, mais votre perspicacit√© est √©vidente.", 22: "<strong>L'Image du B√¢tisseur de Confiance :</strong> Vous projetez une image d'une comp√©tence et d'une fiabilit√© exceptionnelles. On vous per√ßoit comme quelqu'un capable de g√©rer de grands projets avec une aisance d√©concertante.", 33: "<strong>L'Image du Guide Bienveillant :</strong> On vous per√ßoit comme une source d'amour et de compassion. Vous d√©gagez une √©nergie de gu√©rison et de sagesse profonde qui touche les autres au c≈ìur." },
                nombreActif: { 1: "<strong>Action Directe :</strong> Votre pr√©nom vous pousse √† agir de mani√®re directe, ind√©pendante et d√©cisive. Quand une id√©e vous vient, vous avez tendance √† la mettre en ≈ìuvre imm√©diatement, sans attendre les autres.", 2: "<strong>Action Collaborative :</strong> Vous agissez de pr√©f√©rence en collaboration. Avant de vous lancer, vous cherchez √† obtenir le soutien ou l'avis des autres. Votre force r√©side dans l'action de groupe.", 3: "<strong>Action Cr√©ative :</strong> Votre mani√®re d'agir est joyeuse, cr√©ative et expressive. Vous mettez de l'enthousiasme dans vos actions et vous aimez trouver des solutions originales et communiquer sur vos projets.", 4: "<strong>Action M√©thodique :</strong> Vous agissez de fa√ßon planifi√©e, organis√©e et pers√©v√©rante. Vous pr√©f√©rez avancer pas √† pas, en vous assurant que chaque √©tape est solide avant de passer √† la suivante.", 5: "<strong>Action Adaptable :</strong> Vous agissez de mani√®re rapide, flexible et opportuniste. Vous √™tes capable de changer de direction rapidement et de saisir les opportunit√©s au vol. La routine dans l'action vous ennuie.", 6: "<strong>Action Responsable :</strong> Vos actions sont motiv√©es par le sens des responsabilit√©s et le d√©sir d'aider. Vous agissez souvent pour le bien-√™tre des autres, en prenant en compte l'impact de vos d√©cisions sur votre entourage.", 7: "<strong>Action R√©fl√©chie :</strong> Vous n'agissez pas sur un coup de t√™te. Vous avez besoin d'analyser la situation, de rechercher des informations et de comprendre le 'pourquoi' avant de vous engager. Votre action est strat√©gique.", 8: "<strong>Action Ambitieuse :</strong> Votre mode d'action est puissant, efficace et orient√© vers un objectif. Vous agissez avec ambition et autorit√©, en visant des r√©sultats concrets et significatifs.", 9: "<strong>Action Altruiste :</strong> Vous agissez souvent pour une cause plus grande que vous. Vos actions sont empreintes d'id√©alisme et d'une vision √† long terme. Vous √™tes capable de motiver les autres √† agir avec vous.", 11: "<strong>Action Intuitive :</strong> Vous agissez en suivant votre puissante intuition. Vous 'sentez' ce qu'il faut faire, m√™me si ce n'est pas toujours logique. Vos actions sont souvent inspir√©es et peuvent surprendre votre entourage.", 22: "<strong>Action √† Grande √âchelle :</strong> Votre mani√®re d'agir est pragmatique mais vise tr√®s haut. Vous mettez en ≈ìuvre des projets ambitieux avec une efficacit√© redoutable, en transformant des visions en r√©alit√© tangible.", 33: "<strong>Action Compassionnelle :</strong> Vous agissez m√ª par un d√©sir de gu√©rir et de servir. Chacune de vos actions vise √† apporter du r√©confort et de l'aide, souvent au d√©triment de vos propres int√©r√™ts." }
            };

            elements.themeToggle.addEventListener('change', () => { document.body.classList.toggle('dark-mode'); localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light'); });
            if (localStorage.getItem('theme') === 'dark') { document.body.classList.add('dark-mode'); elements.themeToggle.checked = true; }
            const savedUser = JSON.parse(localStorage.getItem('numerologyUser'));
            if (savedUser && savedUser.name && savedUser.date) { elements.nameInput.value = savedUser.name; elements.dateInput.value = savedUser.date; elements.welcomeBack.innerHTML = `Heureux de vous revoir, ${savedUser.name.split(' ')[0]} ! Recalculez votre th√®me ou modifiez les informations.`; elements.welcomeBack.classList.remove('hidden'); displayAllResults(savedUser.name, savedUser.date); }

            elements.form.addEventListener('submit', e => { e.preventDefault(); const fullName = elements.nameInput.value; const birthDate = elements.dateInput.value; if (!fullName || !birthDate) { alert("Veuillez remplir tous les champs."); return; } localStorage.setItem('numerologyUser', JSON.stringify({ name: fullName, date: birthDate })); displayAllResults(fullName, birthDate); });
            
            function reduceNumber(n) { let num = parseInt(n, 10); while (num > 9 && num !== 11 && num !== 22 && num !== 33) { num = String(num).split('').reduce((acc, digit) => acc + parseInt(digit, 10), 0); } return num; }
            function calculateComplexNumber(sum) { const karmicDebt = Object.keys(karmicDebtsMap).map(Number).includes(sum) ? sum : null; const finalValue = reduceNumber(sum); return { value: finalValue, karmicDebt, initialSum: sum }; }
            function calculateNameNumber(name, type) { if (!name) return { value: 0, initialSum: 0, karmicDebt: null, details: "Aucun nom fourni" }; const normalizedName = name.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toUpperCase().replace(/[^A-Z\s]/g, ''); let sum = 0, details = []; for (const char of normalizedName) { if (char === ' ') continue; const isVowel = vowels.includes(char); if ((type === 'all') || (type === 'vowels' && isVowel) || (type === 'consonants' && !isVowel)) { sum += letterValues[char] || 0; details.push(`${char}(${letterValues[char] || 0})`); } } if (details.length === 0) return { value: 0, initialSum: 0, karmicDebt: null, details: "Aucune lettre valide trouv√©e." }; const result = calculateComplexNumber(sum); result.details = `${details.join(' + ')} = ${result.initialSum}${result.karmicDebt ? ' (Dette Karmique ' + result.karmicDebt + ')' : ''} ‚ûî ${result.value}`; return result; }
            function calculateLifePath(date) { const [year, month, day] = date.split('-'); const dayR = reduceNumber(day), monthR = reduceNumber(month), yearR = reduceNumber(year); const sum = dayR + monthR + yearR; const result = calculateComplexNumber(sum); result.details = `Jour(${dayR}) + Mois(${monthR}) + Ann√©e(${yearR}) = ${result.initialSum}${result.karmicDebt ? ' (Dette Karmique ' + result.karmicDebt + ')' : ''} ‚ûî ${result.value}`; return result; }
            function calculateEnergyPresence(fullName) { const presence = { 1:0, 2:0, 3:0, 4:0, 5:0, 6:0, 7:0, 8:0, 9:0 }; const normalizedName = fullName.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toUpperCase().replace(/[^A-Z]/g, ''); for (const char of normalizedName) { if (letterValues[char]) { presence[letterValues[char]]++; } } return presence; }
            function calculateLifeCycles(birthDate, lifePathValue) { const [year, month, day] = birthDate.split('-').map(Number); const dayR = reduceNumber(day), monthR = reduceNumber(month), yearR = reduceNumber(year); const p1 = reduceNumber(monthR + dayR), p2 = reduceNumber(dayR + yearR), p3 = reduceNumber(p1 + p2), p4 = reduceNumber(monthR + yearR); const c1 = reduceNumber(Math.abs(monthR - dayR)), c2 = reduceNumber(Math.abs(dayR - yearR)), c3 = reduceNumber(Math.abs(c1 - c2)), c4 = reduceNumber(Math.abs(monthR - yearR)); const age1 = 36 - lifePathValue; return [ { age: `De 0 √† ${age1} ans`, pinnacle: p1, challenge: c1 }, { age: `De ${age1 + 1} √† ${age1 + 9} ans`, pinnacle: p2, challenge: c2 }, { age: `De ${age1 + 10} √† ${age1 + 18} ans`, pinnacle: p3, challenge: c3 }, { age: `Apr√®s ${age1 + 18} ans`, pinnacle: p4, challenge: c4 } ]; }
            
            function generateEnergyAnalysis(presenceData) {
                const maxCount = Math.max(...Object.values(presenceData));
                const minCount = Math.min(...Object.values(presenceData));
                if (maxCount === 0) return "<div class='energy-analysis'><p>Aucune √©nergie d√©tect√©e dans le nom.</p></div>";
                const maxEnergies = Object.keys(presenceData).filter(k => presenceData[k] === maxCount).map(Number);
                const lackingEnergies = Object.keys(presenceData).filter(k => presenceData[k] === 0).map(Number);
                let analysisHTML = '<div class="energy-analysis"><p><strong>Analyse de vos √©nergies :</strong> ';
                analysisHTML += `Vos √©nergies dominantes sont le <strong>${maxEnergies.join(' et le ')}</strong> (${maxEnergies.map(n => `"${energyKeywords[n]}"`).join(' & ')}). Cela indique des talents naturels et des traits de caract√®re tr√®s marqu√©s dans ces domaines. `;
                if (lackingEnergies.length > 0) {
                    analysisHTML += `√Ä l'inverse, les √©nergies <strong>${lackingEnergies.join(', ')}</strong> (${lackingEnergies.map(n => `"${energyKeywords[n]}"`).join(', ')}) sont absentes de votre nom. Ce sont des domaines que vous pourriez avoir besoin de d√©velopper consciemment pour atteindre un meilleur √©quilibre.`;
                }
                analysisHTML += '</p></div>';
                return analysisHTML;
            }
            function displayEnergyChart(presenceData, analysisHTML) {
                let maxPresence = Math.max(...Object.values(presenceData)); if (maxPresence === 0) maxPresence = 1;
                let chartHTML = `<div class="card chart-card"><h2 style="font-size: 1.5em;">üìä Pr√©sence √ânerg√©tique du Nom</h2><p class="description">Ce graphique montre les √©nergies les plus pr√©sentes dans votre nom de naissance. Une barre haute indique un talent naturel, une barre basse une √©nergie √† d√©velopper.</p><div class="energy-chart-container">`;
                Object.entries(presenceData).forEach(([num, count]) => { const height = (count / maxPresence) * 100; chartHTML += `<div class="bar-wrapper"><div class="bar" style="height: ${height}%;"><span class="tooltip">${energyKeywords[num]} (x${count})</span></div><span class="bar-label">${num}</span></div>`; });
                chartHTML += `</div>${analysisHTML}</div>`;
                elements.energyContainer.innerHTML = chartHTML;
            }
            function displayLifeCycles(cyclesData) { let cyclesHTML = `<div class="card cycles-card"><h2 style="font-size: 1.5em;">üß≠ Vos 4 Cycles de Vie (Pinacles)</h2><div class="life-cycles-grid">`; cyclesData.forEach(cycle => { cyclesHTML += `<div class="cycle-card"><h3>${cycle.age}</h3><p><strong>Pinacle ${cycle.pinnacle}:</strong> Opportunit√©s et ambiance de la p√©riode.</p><p><strong>D√©fi ${cycle.challenge}:</strong> Le√ßon √† int√©grer pour √©voluer.</p></div>`; }); cyclesHTML += `</div></div>`; elements.cyclesContainer.innerHTML = cyclesHTML; }
            function displayAllResults(fullName, birthDate) {
                ['summaryContainer', 'energyContainer', 'cyclesContainer', 'resultsContainer'].forEach(c => elements[c].innerHTML = '');
                const cleanedFullName = fullName.trim().replace(/\s+/g, ' ');
                const firstName = cleanedFullName.split(' ')[0];
                const resultsMap = new Map();
                const lifePathResult = calculateLifePath(birthDate);
                
                resultsMap.set('Chemin de Vie', { key: 'cheminDeVie', result: lifePathResult, description: "Votre mission de vie, les le√ßons √† apprendre, le grand axe de votre destin√©e." });
                resultsMap.set('Nombre d\'Expression', { key: 'expression', result: calculateNameNumber(cleanedFullName, 'all'), description: "Vos talents inn√©s, vos potentiels, vos forces et vos faiblesses." });
                resultsMap.set('Nombre de l\'√Çme', { key: 'ame', result: calculateNameNumber(cleanedFullName, 'vowels'), description: "Ce qui vous motive profond√©ment, vos d√©sirs secrets, votre 'moi' int√©rieur." });
                resultsMap.set('Nombre de Personnalit√©', { key: 'personnalite', result: calculateNameNumber(cleanedFullName, 'consonants'), description: "L'image que vous projetez, ce que les autres per√ßoivent de vous en premier lieu." });
                resultsMap.set('Nombre Actif', { key: 'nombreActif', result: calculateNameNumber(firstName, 'all'), description: "Li√© √† votre pr√©nom, il repr√©sente votre √©nergie d'action au quotidien." });
                
                const summaryCard = document.createElement('div');
                summaryCard.className = 'card summary-card';
                const lp = lifePathResult.value, exp = resultsMap.get("Nombre d'Expression").result.value;
                const lpText = interpretations.cheminDeVie[lp]?.split(':')[0].toLowerCase() || "inconnu", expText = interpretations.expression[exp]?.split(':')[0].toLowerCase() || "inconnu";
                let summaryText = `Votre <strong>Chemin de Vie ${lp}</strong> (votre mission) vous invite √† devenir <strong>${lpText}</strong>. Pour y parvenir, vous disposez des dons de votre <strong>Nombre d'Expression ${exp}</strong> (vos outils), qui vous d√©finit comme <strong>${expText}</strong>.`;
                if (lp === exp || (lp === 11 && exp === 2) || (lp === 22 && exp === 4) || (lp === 33 && exp === 6)) { summaryText += "<br><br>‚ú® <strong>Synergie Puissante :</strong> Votre mission et vos talents sont en parfaite harmonie."; } else { summaryText += "<br><br>üí° <strong>Dynamique de Croissance :</strong> Vos talents et votre mission sont diff√©rents, cr√©ant une dynamique unique."; }
                summaryCard.innerHTML = `<h2>Synth√®se Strat√©gique</h2><p>${summaryText}</p>`;
                elements.summaryContainer.appendChild(summaryCard);

                const energyPresence = calculateEnergyPresence(cleanedFullName);
                const energyAnalysis = generateEnergyAnalysis(energyPresence);
                displayEnergyChart(energyPresence, energyAnalysis);
                const lifeCycles = calculateLifeCycles(birthDate, lifePathResult.value);
                displayLifeCycles(lifeCycles);
                
                resultsMap.forEach((data, title) => {
                    const interpretationText = interpretations[data.key]?.[data.result.value] || "Interpr√©tation non disponible.";
                    const card = document.createElement('div');
                    card.className = 'card result-card';
                    let karmicHTML = '';
                    if(data.result.karmicDebt) { karmicHTML = `<div class="karmic-warning">‚ö†Ô∏è <strong>D√©fi Karmique ${data.result.karmicDebt} :</strong> Ce nombre indique un d√©fi particulier li√© √† ${karmicDebtsMap[data.result.karmicDebt]}.</div>`; }
                    card.innerHTML = `<h2><span class="number-circle">${data.result.value}</span>${title}</h2><p class="description">${data.description}</p><p>${interpretationText}</p>${karmicHTML}<details><summary>Voir le calcul</summary><div class="calculation-details">${data.result.details}</div></details>`;
                    elements.resultsContainer.appendChild(card);
                });

                elements.resultsWrapper.classList.remove('hidden');
                document.querySelectorAll('.card').forEach((card, index) => { card.style.animationDelay = `${index * 0.1}s`; card.classList.add('fade-in'); });
                setTimeout(() => { if(!JSON.parse(localStorage.getItem('isReloaded'))) elements.resultsWrapper.scrollIntoView({ behavior: 'smooth', block: 'start' }); localStorage.setItem('isReloaded', 'false'); }, 200);

                elements.printBtn.onclick = () => window.print();
                elements.aiExportBtn.onclick = () => {
                    let resultsForAI = '';
                    let karmicDebtsForAI = [];
                    resultsMap.forEach((data, title) => { resultsForAI += `${title}: ${data.result.value}\n`; if(data.result.karmicDebt) karmicDebtsForAI.push(`${title} (Dette ${data.result.karmicDebt})`); });
                    const aiPrompt = `# CONTEXTE\nAgis comme un expert en num√©rologie strat√©gique de renomm√©e mondiale. Analyse le th√®me num√©rologique suivant.\n\n# MON TH√àME\n${resultsForAI.trim()}\n\n# CYCLES DE VIE\n${JSON.stringify(lifeCycles)}\n\n# DETTES KARMIQUES D√âTECT√âES\n${karmicDebtsForAI.length > 0 ? karmicDebtsForAI.join(', ') : 'Aucune'}\n\n# TA MISSION\nEn te basant sur TOUTES ces donn√©es, r√©dige une analyse compl√®te, perspicace et encourageante. Ne te contente pas de r√©p√©ter la signification de chaque nombre. Ta valeur est de TISSER DES LIENS entre eux.\n\nStructure ta r√©ponse ainsi :\n1. **Synth√®se Strat√©gique :** En une phrase, quel est le grand paradoxe ou la mission unique de cette personnalit√© ?\n2. **Forces Principales (Synergies) :** Identifie 2-3 associations de nombres qui fonctionnent bien ensemble. Explique comment les utiliser pour r√©ussir.\n3. **Axes de Croissance (D√©fis & Conflits) :** Identifie les 1-2 dynamiques de nombres en tension et les dettes karmiques. Explique comment transformer ces d√©fis en forces.\n4. **Feuille de Route :** En te basant sur les cycles de vie, donne un conseil strat√©gique pour la p√©riode de vie actuelle de la personne (consid√©rant qu'on est en ${new Date().getFullYear()}).\n5. **Conseil Final :** Termine par un conseil global et actionnable pour aligner toutes ces √©nergies.`;
                    navigator.clipboard.writeText(aiPrompt.trim()).then(() => { const originalText = elements.aiExportBtn.innerHTML; elements.aiExportBtn.innerHTML = '‚úÖ Copi√© !'; elements.aiExportBtn.disabled = true; setTimeout(() => { elements.aiExportBtn.innerHTML = originalText; elements.aiExportBtn.disabled = false; }, 2500); }, err => { console.error("Erreur de copie:", err); alert("La copie a √©chou√©."); });
                };
            }
            if (savedUser) { localStorage.setItem('isReloaded', 'true'); }
        });
    </script>
</body>
</html>
